import numpy as np
from numpy import pi, cos, sin, tan
import robot_constants as rc

def get_joint_space_compliance_matrix(nlinks, params, Nfis, Bfis, LBases, LActOffsets, thetas, p_robot):
    try:
        # Note: shape of thetas input is (12,1)
        arm_compl_coef = get_arm_compliance_matrix_coef(nlinks, params, Nfis, Bfis, LBases, LActOffsets, thetas)
        arm_compl_matrix = get_joint_space_compliance_matrix_from_arm_compliance_coef(nlinks, p_robot, arm_compl_coef)
    except Exception as e:
        print("error in get_joint_space_compliance_matrix: ", e)

    return arm_compl_matrix

def get_joint_space_compliance_matrix_from_arm_compliance_coef(nlinks, p_robot, arm_compliance_matrix_coef):
    ### Note!!! this function does not re-calculate the compliance matrix coef
    ### That is to say, it assumes that the robot configuration does not change
    ### Only the pressure is changing.

    ### mp_joint_compliance_matrix_coef is size [1, nlinks, 32]
    ### It is a multiprocessing list, and it be updated by some other process

    config_compliance_matrix = np.zeros((4*nlinks,4*nlinks))

    ujoint_compliance_matrix = np.zeros((2*nlinks, 2, 2), dtype=float)

    for i in range(nlinks):
        coefs = arm_compliance_matrix_coef[i, :]

        p = p_robot[i*8:(i+1)*8]

        ujoint_compliance_matrix[2*i, :, :] = [
            [coefs[ 0]*p[0] + coefs[ 1]*p[1] + coefs[ 2]*p[2] + coefs[ 3]*p[3], coefs[ 4]*p[0] + coefs[ 5]*p[1] + coefs[ 6]*p[2] + coefs[ 7]*p[3]],
            [coefs[ 8]*p[0] + coefs[ 9]*p[1] + coefs[10]*p[2] + coefs[11]*p[3], coefs[12]*p[0] + coefs[13]*p[1] + coefs[14]*p[2] + coefs[15]*p[3]],
        ]

        ujoint_compliance_matrix[2*i + 1, :, :] = [
            [coefs[16]*p[4] + coefs[17]*p[5] + coefs[18]*p[6] + coefs[19]*p[7], coefs[20]*p[4] + coefs[21]*p[5] + coefs[22]*p[6] + coefs[23]*p[7]],
            [coefs[24]*p[4] + coefs[25]*p[5] + coefs[26]*p[6] + coefs[27]*p[7], coefs[28]*p[4] + coefs[29]*p[5] + coefs[30]*p[6] + coefs[31]*p[7]],
        ]
        try:
            config_compliance_matrix[i*4:i*4+2, i*4:i*4+2] = np.linalg.inv(-ujoint_compliance_matrix[2*i, :, :])
            config_compliance_matrix[i*4+2:i*4+4, i*4+2:i*4+4] = np.linalg.inv(-ujoint_compliance_matrix[2*i + 1, :, :])
        except Exception as e:
            # print("Inverting stiffness matrix: ", e)
            # print(p)
            config_compliance_matrix[i*4:i*4+2, i*4:i*4+2] = np.linalg.pinv(-ujoint_compliance_matrix[2*i, :, :])
            config_compliance_matrix[i*4+2:i*4+4, i*4+2:i*4+4] = np.linalg.pinv(-ujoint_compliance_matrix[2*i + 1, :, :]) 
            return config_compliance_matrix
        
    return config_compliance_matrix

def get_arm_compliance_matrix_coef(nlinks, params, Nfis, Bfis, LBases, LActOffsets, thetas):
    # Reshaping the 12x1 thetas to 3x4 theta
    reshaped_theta = np.zeros((rc.nlinks, 4))
    for i in range(rc.nlinks):
        reshaped_theta[i, :] = thetas[i*4 : (i+1)*4]

    new_joint_compliance_matrix_coef = np.zeros((nlinks, 32), dtype=float)
    
    for i in range(nlinks):
        new_joint_compliance_matrix_coef[i, :] = get_segment_compliance_matrix_coef(params[i], Nfis[i], Bfis[i], LBases[i], LActOffsets[i], reshaped_theta[i, :])
    
    return new_joint_compliance_matrix_coef


def get_segment_compliance_matrix_coef(param, Nfi, Bfi, LBase, LActOffset, theta1234):
    [JA1,JA2,UC1,UC2,AA1,AA2,AO1,AO2,LL,JD] = param
    [theta1, theta2, theta3, theta4] = theta1234

    [Nf1, Nf2, Nf3, Nf4, Nf5, Nf6, Nf7, Nf8] = Nfi
    [Bf1, Bf2, Bf3, Bf4, Bf5, Bf6, Bf7, Bf8] = Bfi
    [LBase1, LBase2, LBase3, LBase4, LBase5, LBase6, LBase7, LBase8] = LBase
    [LActOffset1, LActOffset2, LActOffset3, LActOffset4, LActOffset5, LActOffset6, LActOffset7, LActOffset8] = LActOffset

    Nfa = Nf1
    Bfa = Bf1

    coef_matrix = np.array([[(-1/4)*Nfa**(-2)*pi**(-1)*((2*cos(theta1)*sin(theta1)*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(-2)*sin(theta1)*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))*(UC1+cos(theta1)*((AA1+ \
        LL)*cos(theta2)+AO1*sin(theta2))))**2*(sin(theta1)**2*((AA1+ \
        LL)*cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos(theta2)+ \
        (AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2) \
        +AO1*sin(theta2)))**2)**(-1/2)+(2*cos(theta1)**2*((AA1+LL)* \
        cos(theta2)+AO1*sin(theta2))**2+(-2)*cos(theta1)*((AA1+LL)* \
        cos(theta2)+AO1*sin(theta2))*(UC1+cos(theta1)*((AA1+LL)*cos( \
        theta2)+AO1*sin(theta2))))*(sin(theta1)**2*((AA1+LL)*cos( \
        theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos(theta2)+(AA1+LL) \
        *sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+AO1* \
        sin(theta2)))**2)**(1/2)+(-1/4)*(2*cos(theta1)*sin(theta1)*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(-2)*sin(theta1)*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))*(UC1+cos(theta1)*((AA1+ \
        LL)*cos(theta2)+AO1*sin(theta2))))**2*(sin(theta1)**2*((AA1+ \
        LL)*cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos(theta2)+ \
        (AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2) \
        +AO1*sin(theta2)))**2)**(-3/2)*((-1)*Bfa**2+sin(theta1)**2*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos( \
        theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)* \
        cos(theta2)+AO1*sin(theta2)))**2)+(1/2)*(2*cos(theta1)**2*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(-2)*cos(theta1)*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))*(UC1+cos(theta1)*((AA1+ \
        LL)*cos(theta2)+AO1*sin(theta2))))*(sin(theta1)**2*((AA1+LL)* \
        cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos(theta2)+(AA1+ \
        LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+ \
        AO1*sin(theta2)))**2)**(-1/2)*((-1)*Bfa**2+sin(theta1)**2*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos( \
        theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)* \
        cos(theta2)+AO1*sin(theta2)))**2)),(-1/4)*Nfa**(-2)*pi**(-1)*( \
        (2*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1) \
        )*((-1)*AO1*cos(theta1)+(-1)*(AA1+LL)*cos(theta2)*sin( \
        theta1))+2*((AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin( \
        theta1))*((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin( \
        theta1)))**2*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1* \
        sin(theta1))**2+((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2) \
        *sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(-1/2)+(2*((AA1+ \
        LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))**2+2*(UC1+( \
        AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))*((-1)* \
        (AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))+2*((-1)* \
        AO1*cos(theta1)+(-1)*(AA1+LL)*cos(theta2)*sin(theta1))**2+2*( \
        (-1)*AO1*cos(theta1)+(-1)*(AA1+LL)*cos(theta2)*sin(theta1))* \
        ((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1)))* \
        ((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1)) \
        **2+((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1) \
        )**2+(AA1+LL)**2*sin(theta2)**2)**(1/2)+(-1/4)*(2*(UC1+(AA1+LL) \
        *cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))*((-1)*AO1* \
        cos(theta1)+(-1)*(AA1+LL)*cos(theta2)*sin(theta1))+2*((AA1+LL) \
        *cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))*((-1)*JA1+ \
        AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1)))**2*((UC1+( \
        AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))**2+((-1) \
        *JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+( \
        AA1+LL)**2*sin(theta2)**2)**(-3/2)*((-1)*Bfa**2+(UC1+(AA1+LL)* \
        cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))**2+((-1)*JA1+ \
        AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL) \
        **2*sin(theta2)**2)+(1/2)*(2*((AA1+LL)*cos(theta1)*cos( \
        theta2)+(-1)*AO1*sin(theta1))**2+2*(UC1+(AA1+LL)*cos(theta1)* \
        cos(theta2)+(-1)*AO1*sin(theta1))*((-1)*(AA1+LL)*cos(theta1) \
        *cos(theta2)+AO1*sin(theta1))+2*((-1)*AO1*cos(theta1)+(-1)*( \
        AA1+LL)*cos(theta2)*sin(theta1))**2+2*((-1)*AO1*cos(theta1)+( \
        -1)*(AA1+LL)*cos(theta2)*sin(theta1))*((-1)*JA1+AO1*cos( \
        theta1)+(AA1+LL)*cos(theta2)*sin(theta1)))*((UC1+(AA1+LL)*cos( \
        theta1)*cos(theta2)+(-1)*AO1*sin(theta1))**2+((-1)*JA1+AO1* \
        cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2* \
        sin(theta2)**2)**(-1/2)*((-1)*Bfa**2+(UC1+(AA1+LL)*cos(theta1) \
        *cos(theta2)+(-1)*AO1*sin(theta1))**2+((-1)*JA1+AO1*cos( \
        theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin( \
        theta2)**2)),(-1/4)*Nfa**(-2)*pi**(-1)*((2*cos(theta1)*sin( \
        theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+(-2)* \
        sin(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*(UC1+ \
        cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))))**2* \
        (sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)) \
        **2+((-1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+ \
        cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)))**2) \
        **(-1/2)+(2*cos(theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1* \
        sin(theta2))**2+(-2)*cos(theta1)*((AA1+LL)*cos(theta2)+(-1)* \
        AO1*sin(theta2))*(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+(-1)* \
        AO1*sin(theta2))))*(sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1) \
        *AO1*sin(theta2))**2+((-1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin( \
        theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1* \
        sin(theta2)))**2)**(1/2)+(-1/4)*(2*cos(theta1)*sin(theta1)*(( \
        AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+(-2)*sin(theta1) \
        *((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*(UC1+cos(theta1) \
        *((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))))**2*(sin( \
        theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+(( \
        -1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos( \
        theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)))**2)**( \
        -3/2)*((-1)*Bfa**2+sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1)* \
        AO1*sin(theta2))**2+((-1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin( \
        theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1* \
        sin(theta2)))**2)+(1/2)*(2*cos(theta1)**2*((AA1+LL)*cos( \
        theta2)+(-1)*AO1*sin(theta2))**2+(-2)*cos(theta1)*((AA1+LL)* \
        cos(theta2)+(-1)*AO1*sin(theta2))*(UC1+cos(theta1)*((AA1+LL)* \
        cos(theta2)+(-1)*AO1*sin(theta2))))*(sin(theta1)**2*((AA1+LL) \
        *cos(theta2)+(-1)*AO1*sin(theta2))**2+((-1)*JA1+AO1*cos( \
        theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)* \
        cos(theta2)+(-1)*AO1*sin(theta2)))**2)**(-1/2)*((-1)*Bfa**2+ \
        sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+ \
        ((-1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos( \
        theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)))**2)),( \
        -1/4)*Nfa**(-2)*pi**(-1)*((2*(UC1+(AA1+LL)*cos(theta1)*cos( \
        theta2)+AO1*sin(theta1))*(AO1*cos(theta1)+(-1)*(AA1+LL)*cos( \
        theta2)*sin(theta1))+2*((AA1+LL)*cos(theta1)*cos(theta2)+AO1* \
        sin(theta1))*(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)* \
        sin(theta1)))**2*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1* \
        sin(theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2) \
        *sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(-1/2)+(2*((AA1+ \
        LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))**2+2*((-1)*(AA1+ \
        LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))*(UC1+(AA1+ \
        LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))+2*(AO1*cos( \
        theta1)+(-1)*(AA1+LL)*cos(theta2)*sin(theta1))**2+2*(AO1*cos( \
        theta1)+(-1)*(AA1+LL)*cos(theta2)*sin(theta1))*(JA1+(-1)* \
        AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1)))*((UC1+(AA1+ \
        LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))**2+(JA1+(-1)* \
        AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL) \
        **2*sin(theta2)**2)**(1/2)+(-1/4)*(2*(UC1+(AA1+LL)*cos(theta1) \
        *cos(theta2)+AO1*sin(theta1))*(AO1*cos(theta1)+(-1)*(AA1+LL) \
        *cos(theta2)*sin(theta1))+2*((AA1+LL)*cos(theta1)*cos(theta2) \
        +AO1*sin(theta1))*(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos( \
        theta2)*sin(theta1)))**2*((UC1+(AA1+LL)*cos(theta1)*cos( \
        theta2)+AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+LL) \
        *cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**( \
        -3/2)*((-1)*Bfa**2+(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1* \
        sin(theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2) \
        *sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)+(1/2)*(2*((AA1+ \
        LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))**2+2*((-1)*(AA1+ \
        LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))*(UC1+(AA1+ \
        LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))+2*(AO1*cos( \
        theta1)+(-1)*(AA1+LL)*cos(theta2)*sin(theta1))**2+2*(AO1*cos( \
        theta1)+(-1)*(AA1+LL)*cos(theta2)*sin(theta1))*(JA1+(-1)* \
        AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1)))*((UC1+(AA1+ \
        LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))**2+(JA1+(-1)* \
        AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL) \
        **2*sin(theta2)**2)**(-1/2)*((-1)*Bfa**2+(UC1+(AA1+LL)*cos( \
        theta1)*cos(theta2)+AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos( \
        theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin( \
        theta2)**2)),(-1/4)*Nfa**(-2)*pi**(-1)*((2*cos(theta1)*sin( \
        theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(-2)*sin( \
        theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2))*(UC1+cos( \
        theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2))))*(2*sin( \
        theta1)**2*((AA1+LL)*cos(theta2)+AO1*sin(theta2))*(AO1*cos( \
        theta2)+(-1)*(AA1+LL)*sin(theta2))+2*((AA1+LL)*cos(theta2)+ \
        AO1*sin(theta2))*(JA1+(-1)*AO1*cos(theta2)+(AA1+LL)*sin( \
        theta2))+2*cos(theta1)*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin( \
        theta2))*(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin( \
        theta2))))*(sin(theta1)**2*((AA1+LL)*cos(theta2)+AO1*sin( \
        theta2))**2+(JA1+(-1)*AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+ \
        (UC1+cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2)))**2)**( \
        -1/2)+(2*cos(theta1)*sin(theta1)*((AA1+LL)*cos(theta2)+AO1* \
        sin(theta2))*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))+(-2) \
        *sin(theta1)*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))*( \
        UC1+cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2))))*(sin( \
        theta1)**2*((AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1) \
        *AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2)))**2)**(1/2)+(-1/4)*(2* \
        cos(theta1)*sin(theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2)) \
        **2+(-2)*sin(theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2))*( \
        UC1+cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2))))*(2* \
        sin(theta1)**2*((AA1+LL)*cos(theta2)+AO1*sin(theta2))*(AO1* \
        cos(theta2)+(-1)*(AA1+LL)*sin(theta2))+2*((AA1+LL)*cos(theta2) \
        +AO1*sin(theta2))*(JA1+(-1)*AO1*cos(theta2)+(AA1+LL)*sin( \
        theta2))+2*cos(theta1)*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin( \
        theta2))*(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin( \
        theta2))))*(sin(theta1)**2*((AA1+LL)*cos(theta2)+AO1*sin( \
        theta2))**2+(JA1+(-1)*AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+ \
        (UC1+cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2)))**2)**( \
        -3/2)*((-1)*Bfa**2+sin(theta1)**2*((AA1+LL)*cos(theta2)+AO1* \
        sin(theta2))**2+(JA1+(-1)*AO1*cos(theta2)+(AA1+LL)*sin(theta2)) \
        **2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2))) \
        **2)+(1/2)*(2*cos(theta1)*sin(theta1)*((AA1+LL)*cos(theta2)+ \
        AO1*sin(theta2))*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))+ \
        (-2)*sin(theta1)*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2)) \
        *(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2))))*( \
        sin(theta1)**2*((AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(JA1+( \
        -1)*AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)* \
        ((AA1+LL)*cos(theta2)+AO1*sin(theta2)))**2)**(-1/2)*((-1)* \
        Bfa**2+sin(theta1)**2*((AA1+LL)*cos(theta2)+AO1*sin(theta2)) \
        **2+(JA1+(-1)*AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+ \
        cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2)))**2)),(-1/4) \
        *Nfa**(-2)*pi**(-1)*((2*(UC1+(AA1+LL)*cos(theta1)*cos( \
        theta2)+(-1)*AO1*sin(theta1))*((-1)*AO1*cos(theta1)+(-1)*( \
        AA1+LL)*cos(theta2)*sin(theta1))+2*((AA1+LL)*cos(theta1)*cos( \
        theta2)+(-1)*AO1*sin(theta1))*((-1)*JA1+AO1*cos(theta1)+(AA1+ \
        LL)*cos(theta2)*sin(theta1)))*(2*(AA1+LL)**2*cos(theta2)* \
        sin(theta2)+(-2)*(AA1+LL)*cos(theta1)*(UC1+(AA1+LL)*cos( \
        theta1)*cos(theta2)+(-1)*AO1*sin(theta1))*sin(theta2)+(-2)*( \
        AA1+LL)*sin(theta1)*((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos( \
        theta2)*sin(theta1))*sin(theta2))*((UC1+(AA1+LL)*cos(theta1)* \
        cos(theta2)+(-1)*AO1*sin(theta1))**2+((-1)*JA1+AO1*cos(theta1) \
        +(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2) \
        **2)**(-1/2)+((-2)*(AA1+LL)*sin(theta1)*((AA1+LL)*cos(theta1) \
        *cos(theta2)+(-1)*AO1*sin(theta1))*sin(theta2)+2*(AA1+LL)* \
        sin(theta1)*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1* \
        sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*cos(theta1)*((-1)* \
        AO1*cos(theta1)+(-1)*(AA1+LL)*cos(theta2)*sin(theta1))*sin( \
        theta2)+(-2)*(AA1+LL)*cos(theta1)*((-1)*JA1+AO1*cos(theta1)+( \
        AA1+LL)*cos(theta2)*sin(theta1))*sin(theta2))*((UC1+(AA1+LL)* \
        cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))**2+((-1)*JA1+ \
        AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL) \
        **2*sin(theta2)**2)**(1/2)+(-1/4)*(2*(UC1+(AA1+LL)*cos(theta1) \
        *cos(theta2)+(-1)*AO1*sin(theta1))*((-1)*AO1*cos(theta1)+( \
        -1)*(AA1+LL)*cos(theta2)*sin(theta1))+2*((AA1+LL)*cos(theta1) \
        *cos(theta2)+(-1)*AO1*sin(theta1))*((-1)*JA1+AO1*cos(theta1) \
        +(AA1+LL)*cos(theta2)*sin(theta1)))*(2*(AA1+LL)**2*cos( \
        theta2)*sin(theta2)+(-2)*(AA1+LL)*cos(theta1)*(UC1+(AA1+LL)* \
        cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))*sin(theta2)+(-2) \
        *(AA1+LL)*sin(theta1)*((-1)*JA1+AO1*cos(theta1)+(AA1+LL)* \
        cos(theta2)*sin(theta1))*sin(theta2))*((UC1+(AA1+LL)*cos( \
        theta1)*cos(theta2)+(-1)*AO1*sin(theta1))**2+((-1)*JA1+AO1* \
        cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2* \
        sin(theta2)**2)**(-3/2)*((-1)*Bfa**2+(UC1+(AA1+LL)*cos(theta1) \
        *cos(theta2)+(-1)*AO1*sin(theta1))**2+((-1)*JA1+AO1*cos( \
        theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin( \
        theta2)**2)+(1/2)*((-2)*(AA1+LL)*sin(theta1)*((AA1+LL)*cos( \
        theta1)*cos(theta2)+(-1)*AO1*sin(theta1))*sin(theta2)+2*(AA1+ \
        LL)*sin(theta1)*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)* \
        AO1*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*cos(theta1)*((-1) \
        *AO1*cos(theta1)+(-1)*(AA1+LL)*cos(theta2)*sin(theta1))*sin( \
        theta2)+(-2)*(AA1+LL)*cos(theta1)*((-1)*JA1+AO1*cos(theta1)+( \
        AA1+LL)*cos(theta2)*sin(theta1))*sin(theta2))*((UC1+(AA1+LL)* \
        cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))**2+((-1)*JA1+ \
        AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL) \
        **2*sin(theta2)**2)**(-1/2)*((-1)*Bfa**2+(UC1+(AA1+LL)*cos( \
        theta1)*cos(theta2)+(-1)*AO1*sin(theta1))**2+((-1)*JA1+AO1* \
        cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2* \
        sin(theta2)**2)),(-1/4)*Nfa**(-2)*pi**(-1)*((2*cos(theta1)* \
        sin(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+( \
        -2)*sin(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))* \
        (UC1+cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)))) \
        *(2*sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin( \
        theta2))*((-1)*AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))+2* \
        ((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*((-1)*JA1+AO1* \
        cos(theta2)+(AA1+LL)*sin(theta2))+2*cos(theta1)*((-1)*AO1* \
        cos(theta2)+(-1)*(AA1+LL)*sin(theta2))*(UC1+cos(theta1)*((AA1+ \
        LL)*cos(theta2)+(-1)*AO1*sin(theta2))))*(sin(theta1)**2*(( \
        AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+((-1)*JA1+AO1* \
        cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL) \
        *cos(theta2)+(-1)*AO1*sin(theta2)))**2)**(-1/2)+(2*cos(theta1) \
        *sin(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*(( \
        -1)*AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))+(-2)*sin( \
        theta1)*((-1)*AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))*( \
        UC1+cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)))) \
        *(sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)) \
        **2+((-1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+ \
        cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)))**2) \
        **(1/2)+(-1/4)*(2*cos(theta1)*sin(theta1)*((AA1+LL)*cos( \
        theta2)+(-1)*AO1*sin(theta2))**2+(-2)*sin(theta1)*((AA1+LL)* \
        cos(theta2)+(-1)*AO1*sin(theta2))*(UC1+cos(theta1)*((AA1+LL)* \
        cos(theta2)+(-1)*AO1*sin(theta2))))*(2*sin(theta1)**2*((AA1+ \
        LL)*cos(theta2)+(-1)*AO1*sin(theta2))*((-1)*AO1*cos(theta2)+ \
        (-1)*(AA1+LL)*sin(theta2))+2*((AA1+LL)*cos(theta2)+(-1)*AO1* \
        sin(theta2))*((-1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin(theta2))+ \
        2*cos(theta1)*((-1)*AO1*cos(theta2)+(-1)*(AA1+LL)*sin( \
        theta2))*(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin( \
        theta2))))*(sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1* \
        sin(theta2))**2+((-1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin(theta2)) \
        **2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin( \
        theta2)))**2)**(-3/2)*((-1)*Bfa**2+sin(theta1)**2*((AA1+LL)* \
        cos(theta2)+(-1)*AO1*sin(theta2))**2+((-1)*JA1+AO1*cos(theta2) \
        +(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos( \
        theta2)+(-1)*AO1*sin(theta2)))**2)+(1/2)*(2*cos(theta1)*sin( \
        theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*((-1)* \
        AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))+(-2)*sin(theta1)*( \
        (-1)*AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))*(UC1+cos( \
        theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))))*(sin( \
        theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+(( \
        -1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos( \
        theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)))**2)**( \
        -1/2)*((-1)*Bfa**2+sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1)* \
        AO1*sin(theta2))**2+((-1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin( \
        theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1* \
        sin(theta2)))**2)),(-1/4)*Nfa**(-2)*pi**(-1)*((2*(UC1+(AA1+LL) \
        *cos(theta1)*cos(theta2)+AO1*sin(theta1))*(AO1*cos(theta1)+( \
        -1)*(AA1+LL)*cos(theta2)*sin(theta1))+2*((AA1+LL)*cos(theta1) \
        *cos(theta2)+AO1*sin(theta1))*(JA1+(-1)*AO1*cos(theta1)+(AA1+ \
        LL)*cos(theta2)*sin(theta1)))*(2*(AA1+LL)**2*cos(theta2)* \
        sin(theta2)+(-2)*(AA1+LL)*cos(theta1)*(UC1+(AA1+LL)*cos( \
        theta1)*cos(theta2)+AO1*sin(theta1))*sin(theta2)+(-2)*(AA1+LL) \
        *sin(theta1)*(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)* \
        sin(theta1))*sin(theta2))*((UC1+(AA1+LL)*cos(theta1)*cos( \
        theta2)+AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+LL) \
        *cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**( \
        -1/2)+((-2)*(AA1+LL)*sin(theta1)*((AA1+LL)*cos(theta1)*cos( \
        theta2)+AO1*sin(theta1))*sin(theta2)+2*(AA1+LL)*sin(theta1)*( \
        UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))*sin( \
        theta2)+(-2)*(AA1+LL)*cos(theta1)*(AO1*cos(theta1)+(-1)*(AA1+ \
        LL)*cos(theta2)*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*cos( \
        theta1)*(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin( \
        theta1))*sin(theta2))*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+ \
        AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos( \
        theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(1/2)+( \
        -1/4)*(2*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin( \
        theta1))*(AO1*cos(theta1)+(-1)*(AA1+LL)*cos(theta2)*sin( \
        theta1))+2*((AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1)) \
        *(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))) \
        *(2*(AA1+LL)**2*cos(theta2)*sin(theta2)+(-2)*(AA1+LL)*cos( \
        theta1)*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1)) \
        *sin(theta2)+(-2)*(AA1+LL)*sin(theta1)*(JA1+(-1)*AO1*cos( \
        theta1)+(AA1+LL)*cos(theta2)*sin(theta1))*sin(theta2))*((UC1+( \
        AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))**2+(JA1+(-1)* \
        AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL) \
        **2*sin(theta2)**2)**(-3/2)*((-1)*Bfa**2+(UC1+(AA1+LL)*cos( \
        theta1)*cos(theta2)+AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos( \
        theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin( \
        theta2)**2)+(1/2)*((-2)*(AA1+LL)*sin(theta1)*((AA1+LL)*cos( \
        theta1)*cos(theta2)+AO1*sin(theta1))*sin(theta2)+2*(AA1+LL)* \
        sin(theta1)*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin( \
        theta1))*sin(theta2)+(-2)*(AA1+LL)*cos(theta1)*(AO1*cos( \
        theta1)+(-1)*(AA1+LL)*cos(theta2)*sin(theta1))*sin(theta2)+( \
        -2)*(AA1+LL)*cos(theta1)*(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)* \
        cos(theta2)*sin(theta1))*sin(theta2))*((UC1+(AA1+LL)*cos( \
        theta1)*cos(theta2)+AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos( \
        theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin( \
        theta2)**2)**(-1/2)*((-1)*Bfa**2+(UC1+(AA1+LL)*cos(theta1)* \
        cos(theta2)+AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+ \
        LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)),( \
        -1/4)*Nfa**(-2)*pi**(-1)*((2*cos(theta1)*sin(theta1)*((AA1+ \
        LL)*cos(theta2)+AO1*sin(theta2))**2+(-2)*sin(theta1)*((AA1+LL) \
        *cos(theta2)+AO1*sin(theta2))*(UC1+cos(theta1)*((AA1+LL)*cos( \
        theta2)+AO1*sin(theta2))))*(2*sin(theta1)**2*((AA1+LL)*cos( \
        theta2)+AO1*sin(theta2))*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin( \
        theta2))+2*((AA1+LL)*cos(theta2)+AO1*sin(theta2))*(JA1+(-1)* \
        AO1*cos(theta2)+(AA1+LL)*sin(theta2))+2*cos(theta1)*(AO1*cos( \
        theta2)+(-1)*(AA1+LL)*sin(theta2))*(UC1+cos(theta1)*((AA1+LL) \
        *cos(theta2)+AO1*sin(theta2))))*(sin(theta1)**2*((AA1+LL)* \
        cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos(theta2)+(AA1+ \
        LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+ \
        AO1*sin(theta2)))**2)**(-1/2)+(2*cos(theta1)*sin(theta1)*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))*(AO1*cos(theta2)+(-1)*( \
        AA1+LL)*sin(theta2))+(-2)*sin(theta1)*(AO1*cos(theta2)+(-1)*( \
        AA1+LL)*sin(theta2))*(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+ \
        AO1*sin(theta2))))*(sin(theta1)**2*((AA1+LL)*cos(theta2)+AO1* \
        sin(theta2))**2+(JA1+(-1)*AO1*cos(theta2)+(AA1+LL)*sin(theta2)) \
        **2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2))) \
        **2)**(1/2)+(-1/4)*(2*cos(theta1)*sin(theta1)*((AA1+LL)*cos( \
        theta2)+AO1*sin(theta2))**2+(-2)*sin(theta1)*((AA1+LL)*cos( \
        theta2)+AO1*sin(theta2))*(UC1+cos(theta1)*((AA1+LL)*cos( \
        theta2)+AO1*sin(theta2))))*(2*sin(theta1)**2*((AA1+LL)*cos( \
        theta2)+AO1*sin(theta2))*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin( \
        theta2))+2*((AA1+LL)*cos(theta2)+AO1*sin(theta2))*(JA1+(-1)* \
        AO1*cos(theta2)+(AA1+LL)*sin(theta2))+2*cos(theta1)*(AO1*cos( \
        theta2)+(-1)*(AA1+LL)*sin(theta2))*(UC1+cos(theta1)*((AA1+LL) \
        *cos(theta2)+AO1*sin(theta2))))*(sin(theta1)**2*((AA1+LL)* \
        cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos(theta2)+(AA1+ \
        LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+ \
        AO1*sin(theta2)))**2)**(-3/2)*((-1)*Bfa**2+sin(theta1)**2*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos( \
        theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)* \
        cos(theta2)+AO1*sin(theta2)))**2)+(1/2)*(2*cos(theta1)*sin( \
        theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2))*(AO1*cos( \
        theta2)+(-1)*(AA1+LL)*sin(theta2))+(-2)*sin(theta1)*(AO1*cos( \
        theta2)+(-1)*(AA1+LL)*sin(theta2))*(UC1+cos(theta1)*((AA1+LL) \
        *cos(theta2)+AO1*sin(theta2))))*(sin(theta1)**2*((AA1+LL)* \
        cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos(theta2)+(AA1+ \
        LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+ \
        AO1*sin(theta2)))**2)**(-1/2)*((-1)*Bfa**2+sin(theta1)**2*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos( \
        theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)* \
        cos(theta2)+AO1*sin(theta2)))**2)),(-1/4)*Nfa**(-2)*pi**(-1)*( \
        (2*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1) \
        )*((-1)*AO1*cos(theta1)+(-1)*(AA1+LL)*cos(theta2)*sin( \
        theta1))+2*((AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin( \
        theta1))*((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin( \
        theta1)))*(2*(AA1+LL)**2*cos(theta2)*sin(theta2)+(-2)*(AA1+ \
        LL)*cos(theta1)*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)* \
        AO1*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*sin(theta1)*((-1) \
        *JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))*sin( \
        theta2))*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin( \
        theta1))**2+((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)* \
        sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(-1/2)+((-2)*(AA1+ \
        LL)*sin(theta1)*((AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1* \
        sin(theta1))*sin(theta2)+2*(AA1+LL)*sin(theta1)*(UC1+(AA1+LL) \
        *cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))*sin(theta2)+( \
        -2)*(AA1+LL)*cos(theta1)*((-1)*AO1*cos(theta1)+(-1)*(AA1+LL) \
        *cos(theta2)*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*cos( \
        theta1)*((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin( \
        theta1))*sin(theta2))*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+( \
        -1)*AO1*sin(theta1))**2+((-1)*JA1+AO1*cos(theta1)+(AA1+LL)* \
        cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(1/2)+( \
        -1/4)*(2*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin( \
        theta1))*((-1)*AO1*cos(theta1)+(-1)*(AA1+LL)*cos(theta2)* \
        sin(theta1))+2*((AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1* \
        sin(theta1))*((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)* \
        sin(theta1)))*(2*(AA1+LL)**2*cos(theta2)*sin(theta2)+(-2)*( \
        AA1+LL)*cos(theta1)*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1) \
        *AO1*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*sin(theta1)*(( \
        -1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))* \
        sin(theta2))*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1* \
        sin(theta1))**2+((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2) \
        *sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(-3/2)*((-1)* \
        Bfa**2+(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin( \
        theta1))**2+((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)* \
        sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)+(1/2)*((-2)*(AA1+ \
        LL)*sin(theta1)*((AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1* \
        sin(theta1))*sin(theta2)+2*(AA1+LL)*sin(theta1)*(UC1+(AA1+LL) \
        *cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))*sin(theta2)+( \
        -2)*(AA1+LL)*cos(theta1)*((-1)*AO1*cos(theta1)+(-1)*(AA1+LL) \
        *cos(theta2)*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*cos( \
        theta1)*((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin( \
        theta1))*sin(theta2))*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+( \
        -1)*AO1*sin(theta1))**2+((-1)*JA1+AO1*cos(theta1)+(AA1+LL)* \
        cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(-1/2) \
        *((-1)*Bfa**2+(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)* \
        AO1*sin(theta1))**2+((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos( \
        theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)),(-1/4)* \
        Nfa**(-2)*pi**(-1)*((2*cos(theta1)*sin(theta1)*((AA1+LL)* \
        cos(theta2)+(-1)*AO1*sin(theta2))**2+(-2)*sin(theta1)*((AA1+ \
        LL)*cos(theta2)+(-1)*AO1*sin(theta2))*(UC1+cos(theta1)*((AA1+ \
        LL)*cos(theta2)+(-1)*AO1*sin(theta2))))*(2*sin(theta1)**2*(( \
        AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*((-1)*AO1*cos( \
        theta2)+(-1)*(AA1+LL)*sin(theta2))+2*((AA1+LL)*cos(theta2)+( \
        -1)*AO1*sin(theta2))*((-1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin( \
        theta2))+2*cos(theta1)*((-1)*AO1*cos(theta2)+(-1)*(AA1+LL)* \
        sin(theta2))*(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1* \
        sin(theta2))))*(sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1)* \
        AO1*sin(theta2))**2+((-1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin( \
        theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1* \
        sin(theta2)))**2)**(-1/2)+(2*cos(theta1)*sin(theta1)*((AA1+LL) \
        *cos(theta2)+(-1)*AO1*sin(theta2))*((-1)*AO1*cos(theta2)+( \
        -1)*(AA1+LL)*sin(theta2))+(-2)*sin(theta1)*((-1)*AO1*cos( \
        theta2)+(-1)*(AA1+LL)*sin(theta2))*(UC1+cos(theta1)*((AA1+LL) \
        *cos(theta2)+(-1)*AO1*sin(theta2))))*(sin(theta1)**2*((AA1+ \
        LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+((-1)*JA1+AO1*cos( \
        theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)* \
        cos(theta2)+(-1)*AO1*sin(theta2)))**2)**(1/2)+(-1/4)*(2*cos( \
        theta1)*sin(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin( \
        theta2))**2+(-2)*sin(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1* \
        sin(theta2))*(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1* \
        sin(theta2))))*(2*sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1)* \
        AO1*sin(theta2))*((-1)*AO1*cos(theta2)+(-1)*(AA1+LL)*sin( \
        theta2))+2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*((-1) \
        *JA1+AO1*cos(theta2)+(AA1+LL)*sin(theta2))+2*cos(theta1)*(( \
        -1)*AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))*(UC1+cos( \
        theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))))*(sin( \
        theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+(( \
        -1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos( \
        theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)))**2)**( \
        -3/2)*((-1)*Bfa**2+sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1)* \
        AO1*sin(theta2))**2+((-1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin( \
        theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1* \
        sin(theta2)))**2)+(1/2)*(2*cos(theta1)*sin(theta1)*((AA1+LL)* \
        cos(theta2)+(-1)*AO1*sin(theta2))*((-1)*AO1*cos(theta2)+(-1) \
        *(AA1+LL)*sin(theta2))+(-2)*sin(theta1)*((-1)*AO1*cos( \
        theta2)+(-1)*(AA1+LL)*sin(theta2))*(UC1+cos(theta1)*((AA1+LL) \
        *cos(theta2)+(-1)*AO1*sin(theta2))))*(sin(theta1)**2*((AA1+ \
        LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+((-1)*JA1+AO1*cos( \
        theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)* \
        cos(theta2)+(-1)*AO1*sin(theta2)))**2)**(-1/2)*((-1)*Bfa**2+ \
        sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+ \
        ((-1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos( \
        theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)))**2)),( \
        -1/4)*Nfa**(-2)*pi**(-1)*((2*(UC1+(AA1+LL)*cos(theta1)*cos( \
        theta2)+AO1*sin(theta1))*(AO1*cos(theta1)+(-1)*(AA1+LL)*cos( \
        theta2)*sin(theta1))+2*((AA1+LL)*cos(theta1)*cos(theta2)+AO1* \
        sin(theta1))*(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)* \
        sin(theta1)))*(2*(AA1+LL)**2*cos(theta2)*sin(theta2)+(-2)*( \
        AA1+LL)*cos(theta1)*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+ \
        AO1*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*sin(theta1)*(JA1+( \
        -1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))*sin( \
        theta2))*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin( \
        theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)* \
        sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(-1/2)+((-2)*(AA1+ \
        LL)*sin(theta1)*((AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin( \
        theta1))*sin(theta2)+2*(AA1+LL)*sin(theta1)*(UC1+(AA1+LL)* \
        cos(theta1)*cos(theta2)+AO1*sin(theta1))*sin(theta2)+(-2)*( \
        AA1+LL)*cos(theta1)*(AO1*cos(theta1)+(-1)*(AA1+LL)*cos( \
        theta2)*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*cos(theta1)*( \
        JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))* \
        sin(theta2))*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin( \
        theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)* \
        sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(1/2)+(-1/4)*(2*( \
        UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))*(AO1* \
        cos(theta1)+(-1)*(AA1+LL)*cos(theta2)*sin(theta1))+2*((AA1+LL) \
        *cos(theta1)*cos(theta2)+AO1*sin(theta1))*(JA1+(-1)*AO1*cos( \
        theta1)+(AA1+LL)*cos(theta2)*sin(theta1)))*(2*(AA1+LL)**2* \
        cos(theta2)*sin(theta2)+(-2)*(AA1+LL)*cos(theta1)*(UC1+(AA1+ \
        LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))*sin(theta2)+(-2) \
        *(AA1+LL)*sin(theta1)*(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)* \
        cos(theta2)*sin(theta1))*sin(theta2))*((UC1+(AA1+LL)*cos( \
        theta1)*cos(theta2)+AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos( \
        theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin( \
        theta2)**2)**(-3/2)*((-1)*Bfa**2+(UC1+(AA1+LL)*cos(theta1)* \
        cos(theta2)+AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+ \
        LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)+( \
        1/2)*((-2)*(AA1+LL)*sin(theta1)*((AA1+LL)*cos(theta1)*cos( \
        theta2)+AO1*sin(theta1))*sin(theta2)+2*(AA1+LL)*sin(theta1)*( \
        UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))*sin( \
        theta2)+(-2)*(AA1+LL)*cos(theta1)*(AO1*cos(theta1)+(-1)*(AA1+ \
        LL)*cos(theta2)*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*cos( \
        theta1)*(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin( \
        theta1))*sin(theta2))*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+ \
        AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos( \
        theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(-1/2)*(( \
        -1)*Bfa**2+(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin( \
        theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)* \
        sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)),(-1/4)*Nfa**(-2)* \
        pi**(-1)*((2*sin(theta1)**2*((AA1+LL)*cos(theta2)+AO1*sin( \
        theta2))*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))+2*((AA1+ \
        LL)*cos(theta2)+AO1*sin(theta2))*(JA1+(-1)*AO1*cos(theta2)+( \
        AA1+LL)*sin(theta2))+2*cos(theta1)*(AO1*cos(theta2)+(-1)*( \
        AA1+LL)*sin(theta2))*(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+ \
        AO1*sin(theta2))))**2*(sin(theta1)**2*((AA1+LL)*cos(theta2)+ \
        AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos(theta2)+(AA1+LL)*sin( \
        theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin( \
        theta2)))**2)**(-1/2)+(2*sin(theta1)**2*((-1)*(AA1+LL)*cos( \
        theta2)+(-1)*AO1*sin(theta2))*((AA1+LL)*cos(theta2)+AO1*sin( \
        theta2))+2*((AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+2*cos( \
        theta1)**2*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))**2+2* \
        sin(theta1)**2*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))**2+ \
        2*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))*(JA1+(-1)* \
        AO1*cos(theta2)+(AA1+LL)*sin(theta2))+2*cos(theta1)*((-1)*( \
        AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*(UC1+cos(theta1)*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))))*(sin(theta1)**2*((AA1+ \
        LL)*cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos(theta2)+ \
        (AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2) \
        +AO1*sin(theta2)))**2)**(1/2)+(-1/4)*(2*sin(theta1)**2*((AA1+ \
        LL)*cos(theta2)+AO1*sin(theta2))*(AO1*cos(theta2)+(-1)*(AA1+ \
        LL)*sin(theta2))+2*((AA1+LL)*cos(theta2)+AO1*sin(theta2))*( \
        JA1+(-1)*AO1*cos(theta2)+(AA1+LL)*sin(theta2))+2*cos(theta1)* \
        (AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))*(UC1+cos(theta1)* \
        ((AA1+LL)*cos(theta2)+AO1*sin(theta2))))**2*(sin(theta1)**2*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1)*AO1*cos( \
        theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)* \
        cos(theta2)+AO1*sin(theta2)))**2)**(-3/2)*((-1)*Bfa**2+sin( \
        theta1)**2*((AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(JA1+(-1) \
        *AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*(( \
        AA1+LL)*cos(theta2)+AO1*sin(theta2)))**2)+(1/2)*(2*sin(theta1) \
        **2*((-1)*(AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*((AA1+ \
        LL)*cos(theta2)+AO1*sin(theta2))+2*((AA1+LL)*cos(theta2)+AO1* \
        sin(theta2))**2+2*cos(theta1)**2*(AO1*cos(theta2)+(-1)*(AA1+ \
        LL)*sin(theta2))**2+2*sin(theta1)**2*(AO1*cos(theta2)+(-1)*( \
        AA1+LL)*sin(theta2))**2+2*(AO1*cos(theta2)+(-1)*(AA1+LL)*sin( \
        theta2))*(JA1+(-1)*AO1*cos(theta2)+(AA1+LL)*sin(theta2))+2* \
        cos(theta1)*((-1)*(AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)) \
        *(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2))))*( \
        sin(theta1)**2*((AA1+LL)*cos(theta2)+AO1*sin(theta2))**2+(JA1+( \
        -1)*AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)* \
        ((AA1+LL)*cos(theta2)+AO1*sin(theta2)))**2)**(-1/2)*((-1)* \
        Bfa**2+sin(theta1)**2*((AA1+LL)*cos(theta2)+AO1*sin(theta2)) \
        **2+(JA1+(-1)*AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+ \
        cos(theta1)*((AA1+LL)*cos(theta2)+AO1*sin(theta2)))**2)),(-1/4) \
        *Nfa**(-2)*pi**(-1)*((2*(AA1+LL)**2*cos(theta2)*sin(theta2)+ \
        (-2)*(AA1+LL)*cos(theta1)*(UC1+(AA1+LL)*cos(theta1)*cos( \
        theta2)+(-1)*AO1*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*sin( \
        theta1)*((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin( \
        theta1))*sin(theta2))**2*((UC1+(AA1+LL)*cos(theta1)*cos( \
        theta2)+(-1)*AO1*sin(theta1))**2+((-1)*JA1+AO1*cos(theta1)+( \
        AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2) \
        **(-1/2)+(-1/4)*(2*(AA1+LL)**2*cos(theta2)*sin(theta2)+(-2)*( \
        AA1+LL)*cos(theta1)*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1) \
        *AO1*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*sin(theta1)*(( \
        -1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))* \
        sin(theta2))**2*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)* \
        AO1*sin(theta1))**2+((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos( \
        theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(-3/2)*(( \
        -1)*Bfa**2+(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1* \
        sin(theta1))**2+((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2) \
        *sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)+((UC1+(AA1+LL)* \
        cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))**2+((-1)*JA1+ \
        AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL) \
        **2*sin(theta2)**2)**(1/2)*(2*(AA1+LL)**2*cos(theta2)**2+(-2) \
        *(AA1+LL)*cos(theta1)*cos(theta2)*(UC1+(AA1+LL)*cos(theta1)* \
        cos(theta2)+(-1)*AO1*sin(theta1))+(-2)*(AA1+LL)*cos(theta2)* \
        sin(theta1)*((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos(theta2)* \
        sin(theta1))+(-2)*(AA1+LL)**2*sin(theta2)**2+2*(AA1+LL)**2* \
        cos(theta1)**2*sin(theta2)**2+2*(AA1+LL)**2*sin(theta1)**2* \
        sin(theta2)**2)+(1/2)*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+( \
        -1)*AO1*sin(theta1))**2+((-1)*JA1+AO1*cos(theta1)+(AA1+LL)* \
        cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(-1/2) \
        *((-1)*Bfa**2+(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)* \
        AO1*sin(theta1))**2+((-1)*JA1+AO1*cos(theta1)+(AA1+LL)*cos( \
        theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)*(2*(AA1+ \
        LL)**2*cos(theta2)**2+(-2)*(AA1+LL)*cos(theta1)*cos(theta2)*( \
        UC1+(AA1+LL)*cos(theta1)*cos(theta2)+(-1)*AO1*sin(theta1))+( \
        -2)*(AA1+LL)*cos(theta2)*sin(theta1)*((-1)*JA1+AO1*cos( \
        theta1)+(AA1+LL)*cos(theta2)*sin(theta1))+(-2)*(AA1+LL)**2* \
        sin(theta2)**2+2*(AA1+LL)**2*cos(theta1)**2*sin(theta2)**2+2*( \
        AA1+LL)**2*sin(theta1)**2*sin(theta2)**2)),(-1/4)*Nfa**(-2)* \
        pi**(-1)*((2*sin(theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1* \
        sin(theta2))*((-1)*AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2)) \
        +2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*((-1)*JA1+ \
        AO1*cos(theta2)+(AA1+LL)*sin(theta2))+2*cos(theta1)*((-1)* \
        AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))*(UC1+cos(theta1)*( \
        (AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))))**2*(sin(theta1) \
        **2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+((-1)*JA1+ \
        AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*(( \
        AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)))**2)**(-1/2)+(2*(( \
        AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+2*sin(theta1) \
        **2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*((-1)*(AA1+ \
        LL)*cos(theta2)+AO1*sin(theta2))+2*cos(theta1)**2*((-1)*AO1* \
        cos(theta2)+(-1)*(AA1+LL)*sin(theta2))**2+2*sin(theta1)**2*(( \
        -1)*AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))**2+2*((-1)* \
        AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))*((-1)*JA1+AO1* \
        cos(theta2)+(AA1+LL)*sin(theta2))+2*cos(theta1)*((-1)*(AA1+LL) \
        *cos(theta2)+AO1*sin(theta2))*(UC1+cos(theta1)*((AA1+LL)*cos( \
        theta2)+(-1)*AO1*sin(theta2))))*(sin(theta1)**2*((AA1+LL)* \
        cos(theta2)+(-1)*AO1*sin(theta2))**2+((-1)*JA1+AO1*cos(theta2) \
        +(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos( \
        theta2)+(-1)*AO1*sin(theta2)))**2)**(1/2)+(-1/4)*(2*sin( \
        theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*((-1) \
        *AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))+2*((AA1+LL)*cos( \
        theta2)+(-1)*AO1*sin(theta2))*((-1)*JA1+AO1*cos(theta2)+(AA1+ \
        LL)*sin(theta2))+2*cos(theta1)*((-1)*AO1*cos(theta2)+(-1)*( \
        AA1+LL)*sin(theta2))*(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+( \
        -1)*AO1*sin(theta2))))**2*(sin(theta1)**2*((AA1+LL)*cos( \
        theta2)+(-1)*AO1*sin(theta2))**2+((-1)*JA1+AO1*cos(theta2)+( \
        AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos(theta2)+ \
        (-1)*AO1*sin(theta2)))**2)**(-3/2)*((-1)*Bfa**2+sin(theta1) \
        **2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+((-1)*JA1+ \
        AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*(( \
        AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)))**2)+(1/2)*(2*(( \
        AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+2*sin(theta1) \
        **2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))*((-1)*(AA1+ \
        LL)*cos(theta2)+AO1*sin(theta2))+2*cos(theta1)**2*((-1)*AO1* \
        cos(theta2)+(-1)*(AA1+LL)*sin(theta2))**2+2*sin(theta1)**2*(( \
        -1)*AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))**2+2*((-1)* \
        AO1*cos(theta2)+(-1)*(AA1+LL)*sin(theta2))*((-1)*JA1+AO1* \
        cos(theta2)+(AA1+LL)*sin(theta2))+2*cos(theta1)*((-1)*(AA1+LL) \
        *cos(theta2)+AO1*sin(theta2))*(UC1+cos(theta1)*((AA1+LL)*cos( \
        theta2)+(-1)*AO1*sin(theta2))))*(sin(theta1)**2*((AA1+LL)* \
        cos(theta2)+(-1)*AO1*sin(theta2))**2+((-1)*JA1+AO1*cos(theta2) \
        +(AA1+LL)*sin(theta2))**2+(UC1+cos(theta1)*((AA1+LL)*cos( \
        theta2)+(-1)*AO1*sin(theta2)))**2)**(-1/2)*((-1)*Bfa**2+sin( \
        theta1)**2*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2))**2+(( \
        -1)*JA1+AO1*cos(theta2)+(AA1+LL)*sin(theta2))**2+(UC1+cos( \
        theta1)*((AA1+LL)*cos(theta2)+(-1)*AO1*sin(theta2)))**2)),( \
        -1/4)*Nfa**(-2)*pi**(-1)*((2*(AA1+LL)**2*cos(theta2)*sin( \
        theta2)+(-2)*(AA1+LL)*cos(theta1)*(UC1+(AA1+LL)*cos(theta1)* \
        cos(theta2)+AO1*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*sin( \
        theta1)*(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin( \
        theta1))*sin(theta2))**2*((UC1+(AA1+LL)*cos(theta1)*cos( \
        theta2)+AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+LL) \
        *cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**( \
        -1/2)+(-1/4)*(2*(AA1+LL)**2*cos(theta2)*sin(theta2)+(-2)*( \
        AA1+LL)*cos(theta1)*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+ \
        AO1*sin(theta1))*sin(theta2)+(-2)*(AA1+LL)*sin(theta1)*(JA1+( \
        -1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))*sin( \
        theta2))**2*((UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin( \
        theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)* \
        sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**(-3/2)*((-1)* \
        Bfa**2+(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1)) \
        **2+(JA1+(-1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1) \
        )**2+(AA1+LL)**2*sin(theta2)**2)+((UC1+(AA1+LL)*cos(theta1)* \
        cos(theta2)+AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos(theta1)+(AA1+ \
        LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin(theta2)**2)**( \
        1/2)*(2*(AA1+LL)**2*cos(theta2)**2+(-2)*(AA1+LL)*cos(theta1) \
        *cos(theta2)*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin( \
        theta1))+(-2)*(AA1+LL)*cos(theta2)*sin(theta1)*(JA1+(-1)* \
        AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))+(-2)*(AA1+ \
        LL)**2*sin(theta2)**2+2*(AA1+LL)**2*cos(theta1)**2*sin(theta2) \
        **2+2*(AA1+LL)**2*sin(theta1)**2*sin(theta2)**2)+(1/2)*((UC1+( \
        AA1+LL)*cos(theta1)*cos(theta2)+AO1*sin(theta1))**2+(JA1+(-1)* \
        AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL) \
        **2*sin(theta2)**2)**(-1/2)*((-1)*Bfa**2+(UC1+(AA1+LL)*cos( \
        theta1)*cos(theta2)+AO1*sin(theta1))**2+(JA1+(-1)*AO1*cos( \
        theta1)+(AA1+LL)*cos(theta2)*sin(theta1))**2+(AA1+LL)**2*sin( \
        theta2)**2)*(2*(AA1+LL)**2*cos(theta2)**2+(-2)*(AA1+LL)*cos( \
        theta1)*cos(theta2)*(UC1+(AA1+LL)*cos(theta1)*cos(theta2)+ \
        AO1*sin(theta1))+(-2)*(AA1+LL)*cos(theta2)*sin(theta1)*(JA1+( \
        -1)*AO1*cos(theta1)+(AA1+LL)*cos(theta2)*sin(theta1))+(-2)*( \
        AA1+LL)**2*sin(theta2)**2+2*(AA1+LL)**2*cos(theta1)**2*sin( \
        theta2)**2+2*(AA1+LL)**2*sin(theta1)**2*sin(theta2)**2)),(-1/4) \
        *Nfa**(-2)*pi**(-1)*(((-2)*(AA2+LL)*UC2*cos(theta3)*cos( \
        theta4)+(-2)*JA2*(AA2+LL)*cos(theta3)*sin(theta4))*(AA2**2+ \
        AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL) \
        *UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos( \
        theta3))*sin(theta4))**(1/2)+(1/2)*((-2)*(AA2+LL)*UC2*cos( \
        theta3)*cos(theta4)+(-2)*JA2*(AA2+LL)*cos(theta3)*sin(theta4) \
        )*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+ \
        2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+JA2*( \
        AA2+LL)*cos(theta3))*sin(theta4))**(-1/2)*(AA2**2+AO2**2+(-1)* \
        Bfa**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL) \
        *UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos( \
        theta3))*sin(theta4))+(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+ \
        UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4) \
        +2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))**(-1/2)*( \
        (-2)*(AA2+LL)*UC2*cos(theta4)*sin(theta3)+(-2)*JA2*(AA2+LL) \
        *sin(theta3)*sin(theta4))**2+(-1/4)*(AA2**2+AO2**2+JA2**2+2* \
        AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3) \
        )*cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin( \
        theta4))**(-3/2)*(AA2**2+AO2**2+(-1)*Bfa**2+JA2**2+2*AA2*LL+ \
        LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos( \
        theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))*(( \
        -2)*(AA2+LL)*UC2*cos(theta4)*sin(theta3)+(-2)*JA2*(AA2+LL)* \
        sin(theta3)*sin(theta4))**2),(-1/4)*Nfa**(-2)*pi**(-1)*((-1)* \
        ((-2)*cos(theta3)*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta4))+( \
        -2)*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))*(AA2**2+ \
        AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2* \
        JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)*(JA2*(AA2+LL)+AO2*UC2* \
        cos(theta4))*sin(theta3))**(1/2)+(-1/2)*(AA2**2+AO2**2+JA2**2+ \
        2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)* \
        UC2*cos(theta4))+(-2)*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))* \
        sin(theta3))**(-1/2)*((-1)*AA2**2+(-1)*AO2**2+Bfa**2+(-1)* \
        JA2**2+(-2)*AA2*LL+(-1)*LL**2+(-1)*UC2**2+2*cos(theta3)*( \
        AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2* \
        UC2*cos(theta4))*sin(theta3))*((-1)*cos(theta3)*((-2)*AO2* \
        JA2+2*(AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2* \
        cos(theta4))*sin(theta3))+(-1)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+ \
        LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos( \
        theta4))+(-2)*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3)) \
        **(-1/2)*(2*cos(theta3)*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))+( \
        -2)*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta4))*sin(theta3))*(( \
        -2)*cos(theta3)*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))+(-1)*(( \
        -2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))*sin(theta3))+(1/4)* \
        (AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)*(JA2*(AA2+LL)+AO2* \
        UC2*cos(theta4))*sin(theta3))**(-3/2)*((-1)*AA2**2+(-1)* \
        AO2**2+Bfa**2+(-1)*JA2**2+(-2)*AA2*LL+(-1)*LL**2+(-1)*UC2**2+ \
        2*cos(theta3)*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta4))+2*( \
        JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))*((-2)*cos( \
        theta3)*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))+(-1)*((-2)*AO2* \
        JA2+2*(AA2+LL)*UC2*cos(theta4))*sin(theta3))**2),(-1/4)* \
        Nfa**(-2)*pi**(-1)*((-1)*(2*(AA2+LL)*UC2*cos(theta3)*cos( \
        theta4)+(-2)*JA2*(AA2+LL)*cos(theta3)*sin(theta4))*(AA2**2+ \
        AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL) \
        *UC2*cos(theta3))*cos(theta4)+(-2)*(AO2*UC2+JA2*(AA2+LL)* \
        cos(theta3))*sin(theta4))**(1/2)+(-1/2)*((-2)*(AA2+LL)*UC2* \
        cos(theta3)*cos(theta4)+2*JA2*(AA2+LL)*cos(theta3)*sin( \
        theta4))*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+(-2)*(AO2* \
        UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))**(-1/2)*((-1)* \
        AA2**2+(-1)*AO2**2+Bfa**2+(-1)*JA2**2+(-2)*AA2*LL+(-1)*LL**2+ \
        (-1)*UC2**2+2*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta3))*cos( \
        theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))+( \
        -1)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2* \
        JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+(-2)*(AO2*UC2+ \
        JA2*(AA2+LL)*cos(theta3))*sin(theta4))**(-1/2)*(2*(AA2+LL)* \
        UC2*cos(theta4)*sin(theta3)+(-2)*JA2*(AA2+LL)*sin(theta3)* \
        sin(theta4))*((-2)*(AA2+LL)*UC2*cos(theta4)*sin(theta3)+2* \
        JA2*(AA2+LL)*sin(theta3)*sin(theta4))+(1/4)*(AA2**2+AO2**2+ \
        JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2* \
        cos(theta3))*cos(theta4)+(-2)*(AO2*UC2+JA2*(AA2+LL)*cos( \
        theta3))*sin(theta4))**(-3/2)*((-1)*AA2**2+(-1)*AO2**2+Bfa**2+ \
        (-1)*JA2**2+(-2)*AA2*LL+(-1)*LL**2+(-1)*UC2**2+2*(AO2*JA2+( \
        -1)*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+JA2*( \
        AA2+LL)*cos(theta3))*sin(theta4))*((-2)*(AA2+LL)*UC2*cos( \
        theta4)*sin(theta3)+2*JA2*(AA2+LL)*sin(theta3)*sin(theta4)) \
        **2),(-1/4)*Nfa**(-2)*pi**(-1)*(((-1)*cos(theta3)*((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)*(JA2*(AA2+LL)+AO2* \
        UC2*cos(theta4))*sin(theta3))*(AA2**2+AO2**2+JA2**2+2*AA2*LL+ \
        LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos( \
        theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))**( \
        1/2)+(1/2)*((-1)*cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2* \
        cos(theta4))+(-2)*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin( \
        theta3))*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos( \
        theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+2*(JA2*( \
        AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))**(-1/2)*(AA2**2+ \
        AO2**2+(-1)*Bfa**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*(( \
        -2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+ \
        AO2*UC2*cos(theta4))*sin(theta3))+(AA2**2+AO2**2+JA2**2+2* \
        AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)* \
        UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin( \
        theta3))**(-1/2)*(2*cos(theta3)*(JA2*(AA2+LL)+AO2*UC2*cos( \
        theta4))+(-1)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))* \
        sin(theta3))**2+(-1/4)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+ \
        UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4)) \
        +2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))**(-3/2)*( \
        AA2**2+AO2**2+(-1)*Bfa**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos( \
        theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+2*(JA2*( \
        AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))*(2*cos(theta3)*( \
        JA2*(AA2+LL)+AO2*UC2*cos(theta4))+(-1)*((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta4))*sin(theta3))**2),(-1/4)*Nfa**(-2)* \
        pi**(-1)*((AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+ \
        JA2*(AA2+LL)*cos(theta3))*sin(theta4))**(-1/2)*(2*(AO2*UC2+ \
        JA2*(AA2+LL)*cos(theta3))*cos(theta4)+(-1)*((-2)*AO2*JA2+2* \
        (AA2+LL)*UC2*cos(theta3))*sin(theta4))*((-2)*(AA2+LL)*UC2* \
        cos(theta4)*sin(theta3)+(-2)*JA2*(AA2+LL)*sin(theta3)*sin( \
        theta4))+(-1/4)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+(( \
        -2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*( \
        AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))**(-3/2)*( \
        AA2**2+AO2**2+(-1)*Bfa**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+ \
        JA2*(AA2+LL)*cos(theta3))*sin(theta4))*(2*(AO2*UC2+JA2*( \
        AA2+LL)*cos(theta3))*cos(theta4)+(-1)*((-2)*AO2*JA2+2*(AA2+ \
        LL)*UC2*cos(theta3))*sin(theta4))*((-2)*(AA2+LL)*UC2*cos( \
        theta4)*sin(theta3)+(-2)*JA2*(AA2+LL)*sin(theta3)*sin(theta4) \
        )+(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+ \
        2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+JA2*( \
        AA2+LL)*cos(theta3))*sin(theta4))**(1/2)*((-2)*JA2*(AA2+LL)* \
        cos(theta4)*sin(theta3)+2*(AA2+LL)*UC2*sin(theta3)*sin( \
        theta4))+(1/2)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+(( \
        -2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*( \
        AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))**(-1/2)*( \
        AA2**2+AO2**2+(-1)*Bfa**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+ \
        JA2*(AA2+LL)*cos(theta3))*sin(theta4))*((-2)*JA2*(AA2+LL)* \
        cos(theta4)*sin(theta3)+2*(AA2+LL)*UC2*sin(theta3)*sin( \
        theta4))),(-1/4)*Nfa**(-2)*pi**(-1)*((-1/2)*(AA2**2+AO2**2+ \
        JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta4))+(-2)*(JA2*(AA2+LL)+AO2*UC2*cos( \
        theta4))*sin(theta3))**(-1/2)*((-2)*cos(theta3)*(JA2*(AA2+LL) \
        +AO2*UC2*cos(theta4))+(-1)*((-2)*AO2*JA2+2*(AA2+LL)*UC2* \
        cos(theta4))*sin(theta3))*(2*(AA2+LL)*UC2*cos(theta3)*sin( \
        theta4)+(-2)*AO2*UC2*sin(theta3)*sin(theta4))+(-1/2)*(AA2**2+ \
        AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2* \
        JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)*(JA2*(AA2+LL)+AO2*UC2* \
        cos(theta4))*sin(theta3))**(-1/2)*(2*cos(theta3)*(JA2*(AA2+ \
        LL)+AO2*UC2*cos(theta4))+(-2)*(AO2*JA2+(-1)*(AA2+LL)*UC2* \
        cos(theta4))*sin(theta3))*((-2)*(AA2+LL)*UC2*cos(theta3)* \
        sin(theta4)+2*AO2*UC2*sin(theta3)*sin(theta4))+(1/4)*(AA2**2+ \
        AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2* \
        JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)*(JA2*(AA2+LL)+AO2*UC2* \
        cos(theta4))*sin(theta3))**(-3/2)*((-1)*AA2**2+(-1)*AO2**2+ \
        Bfa**2+(-1)*JA2**2+(-2)*AA2*LL+(-1)*LL**2+(-1)*UC2**2+2*cos( \
        theta3)*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta4))+2*(JA2*( \
        AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))*((-2)*cos(theta3)* \
        (JA2*(AA2+LL)+AO2*UC2*cos(theta4))+(-1)*((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta4))*sin(theta3))*((-2)*(AA2+LL)*UC2* \
        cos(theta3)*sin(theta4)+2*AO2*UC2*sin(theta3)*sin(theta4))+( \
        -1)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*(( \
        -2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)*(JA2*(AA2+LL)+ \
        AO2*UC2*cos(theta4))*sin(theta3))**(1/2)*((-2)*AO2*UC2*cos( \
        theta3)*sin(theta4)+(-2)*(AA2+LL)*UC2*sin(theta3)*sin(theta4) \
        )+(-1/2)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos( \
        theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)*( \
        JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))**(-1/2)*((-1) \
        *AA2**2+(-1)*AO2**2+Bfa**2+(-1)*JA2**2+(-2)*AA2*LL+(-1)* \
        LL**2+(-1)*UC2**2+2*cos(theta3)*(AO2*JA2+(-1)*(AA2+LL)*UC2* \
        cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3) \
        )*(2*AO2*UC2*cos(theta3)*sin(theta4)+2*(AA2+LL)*UC2*sin( \
        theta3)*sin(theta4))),(-1/4)*Nfa**(-2)*pi**(-1)*((-1/2)*( \
        AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta3))*cos(theta4)+(-2)*(AO2*UC2+JA2*(AA2+ \
        LL)*cos(theta3))*sin(theta4))**(-1/2)*((-2)*(AO2*UC2+JA2*( \
        AA2+LL)*cos(theta3))*cos(theta4)+(-1)*((-2)*AO2*JA2+2*(AA2+ \
        LL)*UC2*cos(theta3))*sin(theta4))*(2*(AA2+LL)*UC2*cos( \
        theta4)*sin(theta3)+(-2)*JA2*(AA2+LL)*sin(theta3)*sin(theta4) \
        )+(-1/2)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+(-2)*(AO2* \
        UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))**(-1/2)*(2*(AO2* \
        UC2+JA2*(AA2+LL)*cos(theta3))*cos(theta4)+(-2)*(AO2*JA2+(-1) \
        *(AA2+LL)*UC2*cos(theta3))*sin(theta4))*((-2)*(AA2+LL)* \
        UC2*cos(theta4)*sin(theta3)+2*JA2*(AA2+LL)*sin(theta3)*sin( \
        theta4))+(1/4)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+(( \
        -2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+(-2)*( \
        AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))**(-3/2)*((-1) \
        *AA2**2+(-1)*AO2**2+Bfa**2+(-1)*JA2**2+(-2)*AA2*LL+(-1)* \
        LL**2+(-1)*UC2**2+2*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta3)) \
        *cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin( \
        theta4))*((-2)*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*cos( \
        theta4)+(-1)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*sin( \
        theta4))*((-2)*(AA2+LL)*UC2*cos(theta4)*sin(theta3)+2*JA2*( \
        AA2+LL)*sin(theta3)*sin(theta4))+(-1)*(AA2**2+AO2**2+JA2**2+2* \
        AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3) \
        )*cos(theta4)+(-2)*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin( \
        theta4))**(1/2)*((-2)*JA2*(AA2+LL)*cos(theta4)*sin(theta3)+( \
        -2)*(AA2+LL)*UC2*sin(theta3)*sin(theta4))+(-1/2)*(AA2**2+ \
        AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL) \
        *UC2*cos(theta3))*cos(theta4)+(-2)*(AO2*UC2+JA2*(AA2+LL)* \
        cos(theta3))*sin(theta4))**(-1/2)*((-1)*AA2**2+(-1)*AO2**2+ \
        Bfa**2+(-1)*JA2**2+(-2)*AA2*LL+(-1)*LL**2+(-1)*UC2**2+2*( \
        AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*(AO2* \
        UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))*(2*JA2*(AA2+LL)* \
        cos(theta4)*sin(theta3)+2*(AA2+LL)*UC2*sin(theta3)*sin( \
        theta4))),(-1/4)*Nfa**(-2)*pi**(-1)*((AA2**2+AO2**2+JA2**2+2* \
        AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)* \
        UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin( \
        theta3))**(-1/2)*(2*cos(theta3)*(JA2*(AA2+LL)+AO2*UC2*cos( \
        theta4))+(-1)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))* \
        sin(theta3))*((-2)*(AA2+LL)*UC2*cos(theta3)*sin(theta4)+(-2) \
        *AO2*UC2*sin(theta3)*sin(theta4))+(-1/4)*(AA2**2+AO2**2+ \
        JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4) \
        )*sin(theta3))**(-3/2)*(AA2**2+AO2**2+(-1)*Bfa**2+JA2**2+2* \
        AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)* \
        UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin( \
        theta3))*(2*cos(theta3)*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))+( \
        -1)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))*sin(theta3)) \
        *((-2)*(AA2+LL)*UC2*cos(theta3)*sin(theta4)+(-2)*AO2*UC2* \
        sin(theta3)*sin(theta4))+(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+ \
        UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4)) \
        +2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))**(1/2)*(( \
        -2)*AO2*UC2*cos(theta3)*sin(theta4)+2*(AA2+LL)*UC2*sin( \
        theta3)*sin(theta4))+(1/2)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+ \
        LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos( \
        theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))**( \
        -1/2)*(AA2**2+AO2**2+(-1)*Bfa**2+JA2**2+2*AA2*LL+LL**2+UC2**2+ \
        cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+2*( \
        JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))*((-2)*AO2* \
        UC2*cos(theta3)*sin(theta4)+2*(AA2+LL)*UC2*sin(theta3)*sin( \
        theta4))),(-1/4)*Nfa**(-2)*pi**(-1)*((AA2**2+AO2**2+JA2**2+2* \
        AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3) \
        )*cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin( \
        theta4))**(-1/2)*(2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*cos( \
        theta4)+(-1)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*sin( \
        theta4))*((-2)*(AA2+LL)*UC2*cos(theta4)*sin(theta3)+(-2)* \
        JA2*(AA2+LL)*sin(theta3)*sin(theta4))+(-1/4)*(AA2**2+AO2**2+ \
        JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2* \
        cos(theta3))*cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3)) \
        *sin(theta4))**(-3/2)*(AA2**2+AO2**2+(-1)*Bfa**2+JA2**2+2* \
        AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3) \
        )*cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin( \
        theta4))*(2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*cos(theta4)+( \
        -1)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*sin(theta4)) \
        *((-2)*(AA2+LL)*UC2*cos(theta4)*sin(theta3)+(-2)*JA2*(AA2+ \
        LL)*sin(theta3)*sin(theta4))+(AA2**2+AO2**2+JA2**2+2*AA2*LL+ \
        LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos( \
        theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))**( \
        1/2)*((-2)*JA2*(AA2+LL)*cos(theta4)*sin(theta3)+2*(AA2+LL)* \
        UC2*sin(theta3)*sin(theta4))+(1/2)*(AA2**2+AO2**2+JA2**2+2* \
        AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3) \
        )*cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin( \
        theta4))**(-1/2)*(AA2**2+AO2**2+(-1)*Bfa**2+JA2**2+2*AA2*LL+ \
        LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos( \
        theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))*(( \
        -2)*JA2*(AA2+LL)*cos(theta4)*sin(theta3)+2*(AA2+LL)*UC2* \
        sin(theta3)*sin(theta4))),(-1/4)*Nfa**(-2)*pi**(-1)*((-1/2)*( \
        AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)*(JA2*(AA2+LL)+AO2* \
        UC2*cos(theta4))*sin(theta3))**(-1/2)*((-2)*cos(theta3)*( \
        JA2*(AA2+LL)+AO2*UC2*cos(theta4))+(-1)*((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta4))*sin(theta3))*(2*(AA2+LL)*UC2*cos( \
        theta3)*sin(theta4)+(-2)*AO2*UC2*sin(theta3)*sin(theta4))+( \
        -1/2)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)* \
        ((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)*(JA2*(AA2+ \
        LL)+AO2*UC2*cos(theta4))*sin(theta3))**(-1/2)*(2*cos(theta3) \
        *(JA2*(AA2+LL)+AO2*UC2*cos(theta4))+(-2)*(AO2*JA2+(-1)*( \
        AA2+LL)*UC2*cos(theta4))*sin(theta3))*((-2)*(AA2+LL)*UC2* \
        cos(theta3)*sin(theta4)+2*AO2*UC2*sin(theta3)*sin(theta4))+( \
        1/4)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*( \
        (-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)*(JA2*(AA2+LL) \
        +AO2*UC2*cos(theta4))*sin(theta3))**(-3/2)*((-1)*AA2**2+(-1) \
        *AO2**2+Bfa**2+(-1)*JA2**2+(-2)*AA2*LL+(-1)*LL**2+(-1)* \
        UC2**2+2*cos(theta3)*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta4)) \
        +2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))*((-2)* \
        cos(theta3)*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))+(-1)*((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))*sin(theta3))*((-2)*( \
        AA2+LL)*UC2*cos(theta3)*sin(theta4)+2*AO2*UC2*sin(theta3)* \
        sin(theta4))+(-1)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+ \
        cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)* \
        (JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))**(1/2)*((-2) \
        *AO2*UC2*cos(theta3)*sin(theta4)+(-2)*(AA2+LL)*UC2*sin( \
        theta3)*sin(theta4))+(-1/2)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+ \
        LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos( \
        theta4))+(-2)*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3)) \
        **(-1/2)*((-1)*AA2**2+(-1)*AO2**2+Bfa**2+(-1)*JA2**2+(-2)* \
        AA2*LL+(-1)*LL**2+(-1)*UC2**2+2*cos(theta3)*(AO2*JA2+(-1)*( \
        AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4) \
        )*sin(theta3))*(2*AO2*UC2*cos(theta3)*sin(theta4)+2*(AA2+ \
        LL)*UC2*sin(theta3)*sin(theta4))),(-1/4)*Nfa**(-2)*pi**(-1)* \
        ((-1/2)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+(-2)*(AO2* \
        UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))**(-1/2)*((-2)*( \
        AO2*UC2+JA2*(AA2+LL)*cos(theta3))*cos(theta4)+(-1)*((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*sin(theta4))*(2*(AA2+ \
        LL)*UC2*cos(theta4)*sin(theta3)+(-2)*JA2*(AA2+LL)*sin( \
        theta3)*sin(theta4))+(-1/2)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+ \
        LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos( \
        theta4)+(-2)*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4)) \
        **(-1/2)*(2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*cos(theta4)+( \
        -2)*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta3))*sin(theta4))*(( \
        -2)*(AA2+LL)*UC2*cos(theta4)*sin(theta3)+2*JA2*(AA2+LL)* \
        sin(theta3)*sin(theta4))+(1/4)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+ \
        LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos( \
        theta4)+(-2)*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4)) \
        **(-3/2)*((-1)*AA2**2+(-1)*AO2**2+Bfa**2+(-1)*JA2**2+(-2)* \
        AA2*LL+(-1)*LL**2+(-1)*UC2**2+2*(AO2*JA2+(-1)*(AA2+LL)* \
        UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos( \
        theta3))*sin(theta4))*((-2)*(AO2*UC2+JA2*(AA2+LL)*cos( \
        theta3))*cos(theta4)+(-1)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos( \
        theta3))*sin(theta4))*((-2)*(AA2+LL)*UC2*cos(theta4)*sin( \
        theta3)+2*JA2*(AA2+LL)*sin(theta3)*sin(theta4))+(-1)*(AA2**2+ \
        AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL) \
        *UC2*cos(theta3))*cos(theta4)+(-2)*(AO2*UC2+JA2*(AA2+LL)* \
        cos(theta3))*sin(theta4))**(1/2)*((-2)*JA2*(AA2+LL)*cos( \
        theta4)*sin(theta3)+(-2)*(AA2+LL)*UC2*sin(theta3)*sin(theta4) \
        )+(-1/2)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+(-2)*(AO2* \
        UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))**(-1/2)*((-1)* \
        AA2**2+(-1)*AO2**2+Bfa**2+(-1)*JA2**2+(-2)*AA2*LL+(-1)*LL**2+ \
        (-1)*UC2**2+2*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta3))*cos( \
        theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))*( \
        2*JA2*(AA2+LL)*cos(theta4)*sin(theta3)+2*(AA2+LL)*UC2*sin( \
        theta3)*sin(theta4))),(-1/4)*Nfa**(-2)*pi**(-1)*((AA2**2+ \
        AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2* \
        JA2+2*(AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2* \
        cos(theta4))*sin(theta3))**(-1/2)*(2*cos(theta3)*(JA2*(AA2+ \
        LL)+AO2*UC2*cos(theta4))+(-1)*((-2)*AO2*JA2+2*(AA2+LL)* \
        UC2*cos(theta4))*sin(theta3))*((-2)*(AA2+LL)*UC2*cos(theta3) \
        *sin(theta4)+(-2)*AO2*UC2*sin(theta3)*sin(theta4))+(-1/4)*( \
        AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2* \
        UC2*cos(theta4))*sin(theta3))**(-3/2)*(AA2**2+AO2**2+(-1)* \
        Bfa**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2* \
        JA2+2*(AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2* \
        cos(theta4))*sin(theta3))*(2*cos(theta3)*(JA2*(AA2+LL)+AO2* \
        UC2*cos(theta4))+(-1)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos( \
        theta4))*sin(theta3))*((-2)*(AA2+LL)*UC2*cos(theta3)*sin( \
        theta4)+(-2)*AO2*UC2*sin(theta3)*sin(theta4))+(AA2**2+AO2**2+ \
        JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4) \
        )*sin(theta3))**(1/2)*((-2)*AO2*UC2*cos(theta3)*sin(theta4)+ \
        2*(AA2+LL)*UC2*sin(theta3)*sin(theta4))+(1/2)*(AA2**2+AO2**2+ \
        JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4) \
        )*sin(theta3))**(-1/2)*(AA2**2+AO2**2+(-1)*Bfa**2+JA2**2+2* \
        AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)* \
        UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin( \
        theta3))*((-2)*AO2*UC2*cos(theta3)*sin(theta4)+2*(AA2+LL)* \
        UC2*sin(theta3)*sin(theta4))),(-1/4)*Nfa**(-2)*pi**(-1)*((( \
        -1)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+( \
        -2)*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))*(AA2**2+ \
        AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL) \
        *UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos( \
        theta3))*sin(theta4))**(1/2)+(1/2)*((-1)*((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta3))*cos(theta4)+(-2)*(AO2*UC2+JA2*(AA2+ \
        LL)*cos(theta3))*sin(theta4))*(AA2**2+AO2**2+JA2**2+2*AA2*LL+ \
        LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos( \
        theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))**( \
        -1/2)*(AA2**2+AO2**2+(-1)*Bfa**2+JA2**2+2*AA2*LL+LL**2+UC2**2+ \
        ((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*( \
        AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))+(AA2**2+AO2**2+ \
        JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2* \
        cos(theta3))*cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3)) \
        *sin(theta4))**(-1/2)*(2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3)) \
        *cos(theta4)+(-1)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3)) \
        *sin(theta4))**2+(-1/4)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+ \
        UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4) \
        +2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))**(-3/2)*( \
        AA2**2+AO2**2+(-1)*Bfa**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)* \
        AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+ \
        JA2*(AA2+LL)*cos(theta3))*sin(theta4))*(2*(AO2*UC2+JA2*( \
        AA2+LL)*cos(theta3))*cos(theta4)+(-1)*((-2)*AO2*JA2+2*(AA2+ \
        LL)*UC2*cos(theta3))*sin(theta4))**2),(-1/4)*Nfa**(-2)*pi**( \
        -1)*((-1)*(2*(AA2+LL)*UC2*cos(theta3)*cos(theta4)+(-2)* \
        AO2*UC2*cos(theta4)*sin(theta3))*(AA2**2+AO2**2+JA2**2+2* \
        AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)* \
        UC2*cos(theta4))+(-2)*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))* \
        sin(theta3))**(1/2)+(-1/2)*((-2)*(AA2+LL)*UC2*cos(theta3)* \
        cos(theta4)+2*AO2*UC2*cos(theta4)*sin(theta3))*(AA2**2+ \
        AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2* \
        JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)*(JA2*(AA2+LL)+AO2*UC2* \
        cos(theta4))*sin(theta3))**(-1/2)*((-1)*AA2**2+(-1)*AO2**2+ \
        Bfa**2+(-1)*JA2**2+(-2)*AA2*LL+(-1)*LL**2+(-1)*UC2**2+2*cos( \
        theta3)*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta4))+2*(JA2*( \
        AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))+(-1)*(AA2**2+AO2**2+ \
        JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta4))+(-2)*(JA2*(AA2+LL)+AO2*UC2*cos( \
        theta4))*sin(theta3))**(-1/2)*(2*(AA2+LL)*UC2*cos(theta3)* \
        sin(theta4)+(-2)*AO2*UC2*sin(theta3)*sin(theta4))*((-2)*( \
        AA2+LL)*UC2*cos(theta3)*sin(theta4)+2*AO2*UC2*sin(theta3)* \
        sin(theta4))+(1/4)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+ \
        cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+(-2)* \
        (JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))**(-3/2)*((-1) \
        *AA2**2+(-1)*AO2**2+Bfa**2+(-1)*JA2**2+(-2)*AA2*LL+(-1)* \
        LL**2+(-1)*UC2**2+2*cos(theta3)*(AO2*JA2+(-1)*(AA2+LL)*UC2* \
        cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3) \
        )*((-2)*(AA2+LL)*UC2*cos(theta3)*sin(theta4)+2*AO2*UC2* \
        sin(theta3)*sin(theta4))**2),(-1/4)*Nfa**(-2)*pi**(-1)*((-1)* \
        ((-2)*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+( \
        -2)*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))*(AA2**2+ \
        AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL) \
        *UC2*cos(theta3))*cos(theta4)+(-2)*(AO2*UC2+JA2*(AA2+LL)* \
        cos(theta3))*sin(theta4))**(1/2)+(-1/2)*(AA2**2+AO2**2+JA2**2+ \
        2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos( \
        theta3))*cos(theta4)+(-2)*(AO2*UC2+JA2*(AA2+LL)*cos(theta3)) \
        *sin(theta4))**(-1/2)*((-1)*AA2**2+(-1)*AO2**2+Bfa**2+(-1)* \
        JA2**2+(-2)*AA2*LL+(-1)*LL**2+(-1)*UC2**2+2*(AO2*JA2+(-1)*( \
        AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL) \
        *cos(theta3))*sin(theta4))*((-1)*((-2)*AO2*JA2+2*(AA2+LL)* \
        UC2*cos(theta3))*cos(theta4)+2*(AO2*UC2+JA2*(AA2+LL)*cos( \
        theta3))*sin(theta4))+(-1)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+ \
        LL**2+UC2**2+((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*cos( \
        theta4)+(-2)*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4)) \
        **(-1/2)*(2*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*cos(theta4)+( \
        -2)*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta3))*sin(theta4))*(( \
        -2)*(AO2*UC2+JA2*(AA2+LL)*cos(theta3))*cos(theta4)+(-1)*(( \
        -2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta3))*sin(theta4))+(1/4)* \
        (AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta3))*cos(theta4)+(-2)*(AO2*UC2+JA2*(AA2+ \
        LL)*cos(theta3))*sin(theta4))**(-3/2)*((-1)*AA2**2+(-1)* \
        AO2**2+Bfa**2+(-1)*JA2**2+(-2)*AA2*LL+(-1)*LL**2+(-1)*UC2**2+ \
        2*(AO2*JA2+(-1)*(AA2+LL)*UC2*cos(theta3))*cos(theta4)+2*( \
        AO2*UC2+JA2*(AA2+LL)*cos(theta3))*sin(theta4))*((-2)*(AO2* \
        UC2+JA2*(AA2+LL)*cos(theta3))*cos(theta4)+(-1)*((-2)*AO2* \
        JA2+2*(AA2+LL)*UC2*cos(theta3))*sin(theta4))**2),(-1/4)* \
        Nfa**(-2)*pi**(-1)*(((-2)*(AA2+LL)*UC2*cos(theta3)*cos( \
        theta4)+(-2)*AO2*UC2*cos(theta4)*sin(theta3))*(AA2**2+AO2**2+ \
        JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4) \
        )*sin(theta3))**(1/2)+(1/2)*((-2)*(AA2+LL)*UC2*cos(theta3)* \
        cos(theta4)+(-2)*AO2*UC2*cos(theta4)*sin(theta3))*(AA2**2+ \
        AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2* \
        JA2+2*(AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2* \
        cos(theta4))*sin(theta3))**(-1/2)*(AA2**2+AO2**2+(-1)*Bfa**2+ \
        JA2**2+2*AA2*LL+LL**2+UC2**2+cos(theta3)*((-2)*AO2*JA2+2*( \
        AA2+LL)*UC2*cos(theta4))+2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4) \
        )*sin(theta3))+(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos( \
        theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+2*(JA2*( \
        AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))**(-1/2)*((-2)*(AA2+ \
        LL)*UC2*cos(theta3)*sin(theta4)+(-2)*AO2*UC2*sin(theta3)* \
        sin(theta4))**2+(-1/4)*(AA2**2+AO2**2+JA2**2+2*AA2*LL+LL**2+ \
        UC2**2+cos(theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4)) \
        +2*(JA2*(AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))**(-3/2)*( \
        AA2**2+AO2**2+(-1)*Bfa**2+JA2**2+2*AA2*LL+LL**2+UC2**2+cos( \
        theta3)*((-2)*AO2*JA2+2*(AA2+LL)*UC2*cos(theta4))+2*(JA2*( \
        AA2+LL)+AO2*UC2*cos(theta4))*sin(theta3))*((-2)*(AA2+LL)* \
        UC2*cos(theta3)*sin(theta4)+(-2)*AO2*UC2*sin(theta3)*sin( \
        theta4))**2)]
        ], dtype=float)

    return coef_matrix
